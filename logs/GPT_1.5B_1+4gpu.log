start
{'DeviceType.A100': {'tp16_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}}, 'model': {'optimizer_time': 21628.570556640625, 'num_layers': 10, 'batch_generator': 934.1955184936523, 'parameters': [98566144, 50601984, 50601984, 50601984, 50601984, 50601984, 50601984, 50601984, 50601984, 98570240]}, 'DeviceType.V100': {'tp16_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}}}
mark:1
mark:2
mark:3
mark:4
mark:5


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[4], num_stage=1, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 4)]
stage_memory_capacity: [327680]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [251926.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [4], num_stage: 1, batches: 128, gbs: 128, strategies: [(1, 4)], layer_partition: [0, 10]
execution_cost: 10687.949267578126, fb_sync_cost: 1373540.566357422, parameter_upate_costs: 5407.142639160156, dp_cost: 0.0, pp_cost: 0.0
cost: 1509212.6846313477


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[4], num_stage=1, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 2)]
stage_memory_capacity: [327680]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [251926.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [4], num_stage: 1, batches: 64, gbs: 128, strategies: [(2, 2)], layer_partition: [0, 10]
execution_cost: 5343.974633789063, fb_sync_cost: 686770.283178711, parameter_upate_costs: 10814.285278320312, dp_cost: 6.239852241847826, pp_cost: 0.0
cost: 762723.2961266559


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[4], num_stage=1, batches=32, gbs=128)
valid_strategies: [(4, 1)]
stage_memory_capacity: [327680]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [251926.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [4], num_stage: 1, batches: 32, gbs: 128, strategies: [(4, 1)], layer_partition: [0, 10]
execution_cost: 2671.9873168945314, fb_sync_cost: 343385.1415893555, parameter_upate_costs: 21628.570556640625, dp_cost: 18.719556725543477, pp_cost: 0.0
cost: 397598.675611413


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[4], num_stage=1, batches=16, gbs=128)
valid_strategies: [(4, 1)]
stage_memory_capacity: [327680]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [251926.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [4], num_stage: 1, batches: 16, gbs: 128, strategies: [(4, 1)], layer_partition: [0, 10]
execution_cost: 1335.9936584472657, fb_sync_cost: 171692.57079467774, parameter_upate_costs: 21628.570556640625, dp_cost: 18.719556725543477, pp_cost: 0.0
cost: 209622.98286238962


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[4], num_stage=1, batches=8, gbs=128)
valid_strategies: [(4, 1)]
stage_memory_capacity: [327680]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [251926.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [4], num_stage: 1, batches: 8, gbs: 128, strategies: [(4, 1)], layer_partition: [0, 10]
execution_cost: 667.9968292236329, fb_sync_cost: 85846.28539733887, parameter_upate_costs: 21628.570556640625, dp_cost: 18.719556725543477, pp_cost: 0.0
cost: 115635.13648787788


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[4], num_stage=1, batches=4, gbs=128)
valid_strategies: [(4, 1)]
stage_memory_capacity: [327680]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [251926.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [4], num_stage: 1, batches: 4, gbs: 128, strategies: [(4, 1)], layer_partition: [0, 10]
execution_cost: 333.99841461181643, fb_sync_cost: 42923.142698669435, parameter_upate_costs: 21628.570556640625, dp_cost: 18.719556725543477, pp_cost: 0.0
cost: 68641.21330062202


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[4], num_stage=1, batches=2, gbs=128)
valid_strategies: [(4, 1)]
stage_memory_capacity: [327680]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [251926.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [4], num_stage: 1, batches: 2, gbs: 128, strategies: [(4, 1)], layer_partition: [0, 10]
execution_cost: 166.99920730590821, fb_sync_cost: 21461.571349334718, parameter_upate_costs: 21628.570556640625, dp_cost: 18.719556725543477, pp_cost: 0.0
cost: 45144.251706994095


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[4], num_stage=1, batches=1, gbs=128)
invalid_strategy: dp_deg(4), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 2], num_stage=2, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2)]
stage_memory_capacity: [163840, 163840]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [128087.99900000001, 123838.49900000001]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 2], num_stage: 2, batches: 128, gbs: 128, strategies: [(1, 2), (1, 2)], layer_partition: [0, 5, 10]
execution_cost: 5454.86268157959, fb_sync_cost: 1373540.566357422, parameter_upate_costs: 5407.142639160156, dp_cost: 0.0, pp_cost: 0.08695652173913043
cost: 1503979.6850018709


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 2], num_stage=2, batches=64, gbs=128)
valid_strategies: [(2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [128087.99900000001, 123838.49900000001]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 2], num_stage: 2, batches: 64, gbs: 128, strategies: [(2, 1), (2, 1)], layer_partition: [0, 5, 10]
execution_cost: 2748.0340438842773, fb_sync_cost: 686770.283178711, parameter_upate_costs: 10814.285278320312, dp_cost: 6.239894701086956, pp_cost: 0.08695652173913043
cost: 760127.442535732


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 2], num_stage=2, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [128087.99900000001, 123838.49900000001]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 2], num_stage: 2, batches: 32, gbs: 128, strategies: [(2, 1), (2, 1)], layer_partition: [0, 5, 10]
execution_cost: 1394.619725036621, fb_sync_cost: 343385.1415893555, parameter_upate_costs: 10814.285278320312, dp_cost: 6.239894701086956, pp_cost: 0.17391304347826086
cost: 385494.71699225385


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 2], num_stage=2, batches=16, gbs=128)
valid_strategies: [(2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [128087.99900000001, 123838.49900000001]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 2], num_stage: 2, batches: 16, gbs: 128, strategies: [(2, 1), (2, 1)], layer_partition: [0, 5, 10]
execution_cost: 717.912565612793, fb_sync_cost: 171692.57079467774, parameter_upate_costs: 10814.285278320312, dp_cost: 6.239894701086956, pp_cost: 0.34782608695652173
cost: 198178.4846552973


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 2], num_stage=2, batches=8, gbs=128)
valid_strategies: [(2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [128087.99900000001, 123838.49900000001]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 2], num_stage: 2, batches: 8, gbs: 128, strategies: [(2, 1), (2, 1)], layer_partition: [0, 5, 10]
execution_cost: 379.55898590087895, fb_sync_cost: 85846.28539733887, parameter_upate_costs: 10814.285278320312, dp_cost: 6.239894701086956, pp_cost: 0.6956521739130435
cost: 104520.62935638428


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 2], num_stage=2, batches=4, gbs=128)
valid_strategies: [(2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [128087.99900000001, 123838.49900000001]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 2], num_stage: 2, batches: 4, gbs: 128, strategies: [(2, 1), (2, 1)], layer_partition: [0, 5, 10]
execution_cost: 210.38219604492187, fb_sync_cost: 42923.142698669435, parameter_upate_costs: 10814.285278320312, dp_cost: 6.239894701086956, pp_cost: 1.391304347826087
cost: 57692.22344605819


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 2], num_stage=2, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 2], num_stage=2, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 1, 1], num_stage=3, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [140046.999, 63981.498999999996, 47897.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 1, 1], num_stage: 3, batches: 128, gbs: 128, strategies: [(1, 2), (1, 1), (1, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 4019.0333656311036, fb_sync_cost: 1373540.566357422, parameter_upate_costs: 8651.42822265625, dp_cost: 0.0, pp_cost: 0.17391304347826086
cost: 1505788.2282259401


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 1, 1], num_stage=3, batches=64, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [140046.999, 63981.498999999996, 47897.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 1, 1], num_stage: 3, batches: 64, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 2035.772257232666, fb_sync_cost: 686770.283178711, parameter_upate_costs: 8651.42822265625, dp_cost: 4.14164402173913, pp_cost: 0.2608695652173913
cost: 757250.3993557806


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 1, 1], num_stage=3, batches=32, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [140046.999, 63981.498999999996, 47897.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 1, 1], num_stage: 3, batches: 32, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 1044.1417030334474, fb_sync_cost: 343385.1415893555, parameter_upate_costs: 8651.42822265625, dp_cost: 4.14164402173913, pp_cost: 0.5217391304347826
cost: 382979.63148999424


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 1, 1], num_stage=3, batches=16, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [140046.999, 63981.498999999996, 47897.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 1, 1], num_stage: 3, batches: 16, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 548.3264259338379, fb_sync_cost: 171692.57079467774, parameter_upate_costs: 8651.42822265625, dp_cost: 4.14164402173913, pp_cost: 1.0434782608695652
cost: 195844.63886144885


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 1, 1], num_stage=3, batches=8, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [140046.999, 63981.498999999996, 47897.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [2, 1, 1], num_stage: 3, batches: 8, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 300.4187873840332, fb_sync_cost: 85846.28539733887, parameter_upate_costs: 8651.42822265625, dp_cost: 4.14164402173913, pp_cost: 2.0869565217391304
cost: 102277.92515587185


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 1, 1], num_stage=3, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 1, 1], num_stage=3, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[2, 1, 1], num_stage=3, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=1, device_groups=[1, 2, 1], num_stage=3, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 2), (1, 1)]
stage_memory_capacity: [81920, 163840, 81920]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [58126.998999999996, 145901.499, 47897.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 2, 1], num_stage: 3, batches: 128, gbs: 128, strategies: [(1, 1), (1, 2), (1, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 4019.0333656311036, fb_sync_cost: 1373540.566357422, parameter_upate_costs: 8651.42822265625, dp_cost: 0.0, pp_cost: 0.17391304347826086
cost: 1505788.2282259401


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=1, device_groups=[1, 2, 1], num_stage=3, batches=64, gbs=128)
valid_strategies: [(1, 1), (2, 1), (1, 1)]
stage_memory_capacity: [81920, 163840, 81920]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [58126.998999999996, 145901.499, 47897.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 2, 1], num_stage: 3, batches: 64, gbs: 128, strategies: [(1, 1), (2, 1), (1, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 2035.772257232666, fb_sync_cost: 686770.283178711, parameter_upate_costs: 8651.42822265625, dp_cost: 3.1472486413043477, pp_cost: 0.2608695652173913
cost: 757249.4049604002


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=1, device_groups=[1, 2, 1], num_stage=3, batches=32, gbs=128)
valid_strategies: [(1, 1), (2, 1), (1, 1)]
stage_memory_capacity: [81920, 163840, 81920]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [58126.998999999996, 145901.499, 47897.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 2, 1], num_stage: 3, batches: 32, gbs: 128, strategies: [(1, 1), (2, 1), (1, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 1044.1417030334474, fb_sync_cost: 343385.1415893555, parameter_upate_costs: 8651.42822265625, dp_cost: 3.1472486413043477, pp_cost: 0.5217391304347826
cost: 382978.6370946138


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=1, device_groups=[1, 2, 1], num_stage=3, batches=16, gbs=128)
valid_strategies: [(1, 1), (2, 1), (1, 1)]
stage_memory_capacity: [81920, 163840, 81920]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [58126.998999999996, 145901.499, 47897.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 2, 1], num_stage: 3, batches: 16, gbs: 128, strategies: [(1, 1), (2, 1), (1, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 548.3264259338379, fb_sync_cost: 171692.57079467774, parameter_upate_costs: 8651.42822265625, dp_cost: 3.1472486413043477, pp_cost: 1.0434782608695652
cost: 195843.64446606842


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=1, device_groups=[1, 2, 1], num_stage=3, batches=8, gbs=128)
valid_strategies: [(1, 1), (2, 1), (1, 1)]
stage_memory_capacity: [81920, 163840, 81920]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [58126.998999999996, 145901.499, 47897.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 2, 1], num_stage: 3, batches: 8, gbs: 128, strategies: [(1, 1), (2, 1), (1, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 300.4187873840332, fb_sync_cost: 85846.28539733887, parameter_upate_costs: 8651.42822265625, dp_cost: 3.1472486413043477, pp_cost: 2.0869565217391304
cost: 102276.93076049142


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=1, device_groups=[1, 2, 1], num_stage=3, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=1, device_groups=[1, 2, 1], num_stage=3, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=1, device_groups=[1, 2, 1], num_stage=3, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=2, device_groups=[1, 1, 2], num_stage=3, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [81920, 81920, 163840]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [58126.998999999996, 63981.498999999996, 129817.99900000001]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 1, 2], num_stage: 3, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 2)], layer_partition: [0, 3, 6, 10]
execution_cost: 4019.0333656311036, fb_sync_cost: 1373540.566357422, parameter_upate_costs: 6488.5711669921875, dp_cost: 0.0, pp_cost: 0.17391304347826086
cost: 1503625.371170276


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=2, device_groups=[1, 1, 2], num_stage=3, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [58126.998999999996, 63981.498999999996, 129817.99900000001]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 1, 2], num_stage: 3, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 2035.772257232666, fb_sync_cost: 686770.283178711, parameter_upate_costs: 8651.42822265625, dp_cost: 5.190811820652174, pp_cost: 0.34782608695652173
cost: 757251.5354801012


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=2, device_groups=[1, 1, 2], num_stage=3, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [58126.998999999996, 63981.498999999996, 129817.99900000001]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 1, 2], num_stage: 3, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 1044.1417030334474, fb_sync_cost: 343385.1415893555, parameter_upate_costs: 8651.42822265625, dp_cost: 5.190811820652174, pp_cost: 0.6956521739130435
cost: 382980.85457083664


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=2, device_groups=[1, 1, 2], num_stage=3, batches=16, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [58126.998999999996, 63981.498999999996, 129817.99900000001]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 1, 2], num_stage: 3, batches: 16, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 548.3264259338379, fb_sync_cost: 171692.57079467774, parameter_upate_costs: 8651.42822265625, dp_cost: 5.190811820652174, pp_cost: 1.391304347826087
cost: 195846.03585533475


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=2, device_groups=[1, 1, 2], num_stage=3, batches=8, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840]
stage_compute_performance: [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [23793.001, 17938.501, 34022.001], memory_state: [58126.998999999996, 63981.498999999996, 129817.99900000001]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 1, 2], num_stage: 3, batches: 8, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 300.4187873840332, fb_sync_cost: 85846.28539733887, parameter_upate_costs: 8651.42822265625, dp_cost: 5.190811820652174, pp_cost: 2.782608695652174
cost: 102279.66997584466


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=2, device_groups=[1, 1, 2], num_stage=3, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=2, device_groups=[1, 1, 2], num_stage=3, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=2, device_groups=[1, 1, 2], num_stage=3, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[1, 1, 1, 1], num_stage=4, batches=128, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [58126.998999999996, 69960.999, 69960.999, 53877.498999999996]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 1, 1, 1], num_stage: 4, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 2859.757033538818, fb_sync_cost: 1373540.566357422, parameter_upate_costs: 6488.5711669921875, dp_cost: 0.0, pp_cost: 0.2608695652173913
cost: 1502466.1817947056


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[1, 1, 1, 1], num_stage=4, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [58126.998999999996, 69960.999, 69960.999, 53877.498999999996]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 1, 1, 1], num_stage: 4, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 1460.6981712341308, fb_sync_cost: 686770.283178711, parameter_upate_costs: 6488.5711669921875, dp_cost: 0.0, pp_cost: 0.5217391304347826
cost: 754508.5874396615


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[1, 1, 1, 1], num_stage=4, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [58126.998999999996, 69960.999, 69960.999, 53877.498999999996]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 1, 1, 1], num_stage: 4, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 761.1687400817871, fb_sync_cost: 343385.1415893555, parameter_upate_costs: 6488.5711669921875, dp_cost: 0.0, pp_cost: 1.0434782608695652
cost: 380530.1815664872


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[1, 1, 1, 1], num_stage=4, batches=16, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [58126.998999999996, 69960.999, 69960.999, 53877.498999999996]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 1, 1, 1], num_stage: 4, batches: 16, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 411.4040245056152, fb_sync_cost: 171692.57079467774, parameter_upate_costs: 6488.5711669921875, dp_cost: 0.0, pp_cost: 2.0869565217391304
cost: 193541.7612385957


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[1, 1, 1, 1], num_stage=4, batches=8, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [58126.998999999996, 69960.999, 69960.999, 53877.498999999996]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [1, 1, 1, 1], num_stage: 4, batches: 8, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 236.52166671752929, fb_sync_cost: 85846.28539733887, parameter_upate_costs: 6488.5711669921875, dp_cost: 0.0, pp_cost: 4.173913043478261
cost: 100049.11629204128


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[1, 1, 1, 1], num_stage=4, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[1, 1, 1, 1], num_stage=4, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[1, 1, 1, 1], num_stage=4, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
Total_time: 0.01 seconds
mark:6
len(costs): 33
rank, cost, node_sequence, device_groups, strategies(dp_deg, tp_deg), batches(number of batch), layer_partition
1, 45144.251706994095, (<DeviceType.A100: 'a100'>,), [4], [(4, 1)], 2, [0, 10]
2, 57692.22344605819, (<DeviceType.A100: 'a100'>,), [2, 2], [(2, 1), (2, 1)], 4, [0, 5, 10]
3, 68641.21330062202, (<DeviceType.A100: 'a100'>,), [4], [(4, 1)], 4, [0, 10]
4, 100049.11629204128, (<DeviceType.A100: 'a100'>,), [1, 1, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1)], 8, [0, 3, 5, 7, 10]
5, 102276.93076049142, (<DeviceType.A100: 'a100'>,), [1, 2, 1], [(1, 1), (2, 1), (1, 1)], 8, [0, 3, 6, 10]
6, 102277.92515587185, (<DeviceType.A100: 'a100'>,), [2, 1, 1], [(2, 1), (1, 1), (1, 1)], 8, [0, 3, 6, 10]
7, 102279.66997584466, (<DeviceType.A100: 'a100'>,), [1, 1, 2], [(1, 1), (1, 1), (2, 1)], 8, [0, 3, 6, 10]
8, 104520.62935638428, (<DeviceType.A100: 'a100'>,), [2, 2], [(2, 1), (2, 1)], 8, [0, 5, 10]
9, 115635.13648787788, (<DeviceType.A100: 'a100'>,), [4], [(4, 1)], 8, [0, 10]
10, 193541.7612385957, (<DeviceType.A100: 'a100'>,), [1, 1, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1)], 16, [0, 3, 5, 7, 10]
11, 195843.64446606842, (<DeviceType.A100: 'a100'>,), [1, 2, 1], [(1, 1), (2, 1), (1, 1)], 16, [0, 3, 6, 10]
12, 195844.63886144885, (<DeviceType.A100: 'a100'>,), [2, 1, 1], [(2, 1), (1, 1), (1, 1)], 16, [0, 3, 6, 10]
13, 195846.03585533475, (<DeviceType.A100: 'a100'>,), [1, 1, 2], [(1, 1), (1, 1), (2, 1)], 16, [0, 3, 6, 10]
14, 198178.4846552973, (<DeviceType.A100: 'a100'>,), [2, 2], [(2, 1), (2, 1)], 16, [0, 5, 10]
15, 209622.98286238962, (<DeviceType.A100: 'a100'>,), [4], [(4, 1)], 16, [0, 10]
16, 380530.1815664872, (<DeviceType.A100: 'a100'>,), [1, 1, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1)], 32, [0, 3, 5, 7, 10]
17, 382978.6370946138, (<DeviceType.A100: 'a100'>,), [1, 2, 1], [(1, 1), (2, 1), (1, 1)], 32, [0, 3, 6, 10]
18, 382979.63148999424, (<DeviceType.A100: 'a100'>,), [2, 1, 1], [(2, 1), (1, 1), (1, 1)], 32, [0, 3, 6, 10]
19, 382980.85457083664, (<DeviceType.A100: 'a100'>,), [1, 1, 2], [(1, 1), (1, 1), (2, 1)], 32, [0, 3, 6, 10]
20, 385494.71699225385, (<DeviceType.A100: 'a100'>,), [2, 2], [(2, 1), (2, 1)], 32, [0, 5, 10]
21, 397598.675611413, (<DeviceType.A100: 'a100'>,), [4], [(4, 1)], 32, [0, 10]
22, 754508.5874396615, (<DeviceType.A100: 'a100'>,), [1, 1, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1)], 64, [0, 3, 5, 7, 10]
23, 757249.4049604002, (<DeviceType.A100: 'a100'>,), [1, 2, 1], [(1, 1), (2, 1), (1, 1)], 64, [0, 3, 6, 10]
24, 757250.3993557806, (<DeviceType.A100: 'a100'>,), [2, 1, 1], [(2, 1), (1, 1), (1, 1)], 64, [0, 3, 6, 10]
25, 757251.5354801012, (<DeviceType.A100: 'a100'>,), [1, 1, 2], [(1, 1), (1, 1), (2, 1)], 64, [0, 3, 6, 10]
26, 760127.442535732, (<DeviceType.A100: 'a100'>,), [2, 2], [(2, 1), (2, 1)], 64, [0, 5, 10]
27, 762723.2961266559, (<DeviceType.A100: 'a100'>,), [4], [(2, 2)], 64, [0, 10]
28, 1502466.1817947056, (<DeviceType.A100: 'a100'>,), [1, 1, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1)], 128, [0, 3, 5, 7, 10]
29, 1503625.371170276, (<DeviceType.A100: 'a100'>,), [1, 1, 2], [(1, 1), (1, 1), (1, 2)], 128, [0, 3, 6, 10]
30, 1503979.6850018709, (<DeviceType.A100: 'a100'>,), [2, 2], [(1, 2), (1, 2)], 128, [0, 5, 10]
31, 1505788.2282259401, (<DeviceType.A100: 'a100'>,), [2, 1, 1], [(1, 2), (1, 1), (1, 1)], 128, [0, 3, 6, 10]
32, 1505788.2282259401, (<DeviceType.A100: 'a100'>,), [1, 2, 1], [(1, 1), (1, 2), (1, 1)], 128, [0, 3, 6, 10]
33, 1509212.6846313477, (<DeviceType.A100: 'a100'>,), [4], [(1, 4)], 128, [0, 10]
