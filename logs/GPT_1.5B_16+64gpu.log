start
{'DeviceType.A100': {'tp16_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}}, 'model': {'optimizer_time': 21628.570556640625, 'num_layers': 10, 'batch_generator': 934.1955184936523, 'parameters': [98566144, 50601984, 50601984, 50601984, 50601984, 50601984, 50601984, 50601984, 50601984, 98570240]}, 'DeviceType.V100': {'tp16_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp16_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp1_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp2_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp32_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp3_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp4_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp64_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs1': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs16': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs2': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs4': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}, 'tp8_bs8': {'time': {'layer-computes': [1.4263919830322267, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 10730.785674667359}, 'memory': [2366.8, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 1195.9, 3216.7]}}}
mark:1
mark:2
mark:3
mark:4
mark:5


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[64], num_stage=1, batches=128, gbs=128)
invalid_strategy: dp_deg(64), batches(128), mbs(0)
invalid_strategy: dp_deg(32), batches(128), mbs(0)
invalid_strategy: dp_deg(16), batches(128), mbs(0)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 64)]
stage_memory_capacity: [5242880]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [5167126.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [64], num_stage: 1, batches: 128, gbs: 128, strategies: [(1, 64)], layer_partition: [0, 10]
execution_cost: 10687.949267578126, fb_sync_cost: 1373540.566357422, parameter_upate_costs: 337.94641494750977, dp_cost: 0.0, pp_cost: 0.0
cost: 1504143.488407135


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[64], num_stage=1, batches=64, gbs=128)
invalid_strategy: dp_deg(64), batches(64), mbs(0)
invalid_strategy: dp_deg(32), batches(64), mbs(0)
invalid_strategy: dp_deg(16), batches(64), mbs(0)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 32)]
stage_memory_capacity: [5242880]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [5167126.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [64], num_stage: 1, batches: 64, gbs: 128, strategies: [(2, 32)], layer_partition: [0, 10]
execution_cost: 5343.974633789063, fb_sync_cost: 686770.283178711, parameter_upate_costs: 675.8928298950195, dp_cost: 0.38999076511548914, pp_cost: 0.0
cost: 752579.0538167539


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[64], num_stage=1, batches=32, gbs=128)
invalid_strategy: dp_deg(64), batches(32), mbs(0)
invalid_strategy: dp_deg(32), batches(32), mbs(0)
invalid_strategy: dp_deg(16), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
valid_strategies: [(4, 16)]
stage_memory_capacity: [5242880]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [5167126.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [64], num_stage: 1, batches: 32, gbs: 128, strategies: [(4, 16)], layer_partition: [0, 10]
execution_cost: 2671.9873168945314, fb_sync_cost: 343385.1415893555, parameter_upate_costs: 1351.785659790039, dp_cost: 1.1699722953464673, pp_cost: 0.0
cost: 377304.34113013226


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[64], num_stage=1, batches=16, gbs=128)
invalid_strategy: dp_deg(64), batches(16), mbs(0)
invalid_strategy: dp_deg(32), batches(16), mbs(0)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
valid_strategies: [(8, 8)]
stage_memory_capacity: [5242880]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [5167126.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [64], num_stage: 1, batches: 16, gbs: 128, strategies: [(8, 8)], layer_partition: [0, 10]
execution_cost: 1335.9936584472657, fb_sync_cost: 171692.57079467774, parameter_upate_costs: 2703.571319580078, dp_cost: 2.7299353558084243, pp_cost: 0.0
cost: 190681.99400395932


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[64], num_stage=1, batches=8, gbs=128)
invalid_strategy: dp_deg(64), batches(8), mbs(0)
invalid_strategy: dp_deg(32), batches(8), mbs(0)
valid_strategies: [(16, 4)]
stage_memory_capacity: [5242880]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [5167126.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [64], num_stage: 1, batches: 8, gbs: 128, strategies: [(16, 4)], layer_partition: [0, 10]
execution_cost: 667.9968292236329, fb_sync_cost: 85846.28539733887, parameter_upate_costs: 5407.142639160156, dp_cost: 5.849861476732337, pp_cost: 0.0
cost: 99400.8388751486


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[64], num_stage=1, batches=4, gbs=128)
invalid_strategy: dp_deg(64), batches(4), mbs(0)
valid_strategies: [(32, 2)]
stage_memory_capacity: [5242880]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [5167126.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [64], num_stage: 1, batches: 4, gbs: 128, strategies: [(32, 2)], layer_partition: [0, 10]
execution_cost: 333.99841461181643, fb_sync_cost: 42923.142698669435, parameter_upate_costs: 10814.285278320312, dp_cost: 12.089713718580162, pp_cost: 0.0
cost: 57820.298179294754


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[64], num_stage=1, batches=2, gbs=128)
valid_strategies: [(64, 1)]
stage_memory_capacity: [5242880]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [5167126.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [64], num_stage: 1, batches: 2, gbs: 128, strategies: [(64, 1)], layer_partition: [0, 10]
execution_cost: 166.99920730590821, fb_sync_cost: 21461.571349334718, parameter_upate_costs: 21628.570556640625, dp_cost: 24.569418202275816, pp_cost: 0.0
cost: 45150.10156847083


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[64], num_stage=1, batches=1, gbs=128)
valid_strategies: [(64, 1)]
stage_memory_capacity: [5242880]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [75753.50099999999], memory_state: [5167126.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [64], num_stage: 1, batches: 1, gbs: 128, strategies: [(64, 1)], layer_partition: [0, 10]
execution_cost: 83.49960365295411, fb_sync_cost: 10730.785674667359, parameter_upate_costs: 21628.570556640625, dp_cost: 24.569418202275816, pp_cost: 0.0
cost: 33401.62077165686


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[32, 32], num_stage=2, batches=128, gbs=128)
invalid_strategy: dp_deg(32), batches(128), mbs(0)
invalid_strategy: dp_deg(16), batches(128), mbs(0)
invalid_strategy: dp_deg(16), batches(128), mbs(0)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 32), (1, 32)]
stage_memory_capacity: [2621440, 2621440]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [2585687.999, 2581438.499]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [32, 32], num_stage: 2, batches: 128, gbs: 128, strategies: [(1, 32), (1, 32)], layer_partition: [0, 5, 10]
execution_cost: 5454.86268157959, fb_sync_cost: 1373540.566357422, parameter_upate_costs: 337.94641494750977, dp_cost: 0.0, pp_cost: 0.08695652173913043
cost: 1498910.4887776582


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[32, 32], num_stage=2, batches=64, gbs=128)
invalid_strategy: dp_deg(32), batches(64), mbs(0)
invalid_strategy: dp_deg(16), batches(64), mbs(0)
invalid_strategy: dp_deg(16), batches(64), mbs(0)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 16), (2, 16)]
stage_memory_capacity: [2621440, 2621440]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [2585687.999, 2581438.499]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [32, 32], num_stage: 2, batches: 64, gbs: 128, strategies: [(2, 16), (2, 16)], layer_partition: [0, 5, 10]
execution_cost: 2748.0340438842773, fb_sync_cost: 686770.283178711, parameter_upate_costs: 675.8928298950195, dp_cost: 0.38999341881793476, pp_cost: 0.08695652173913043
cost: 749983.2001860245


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[32, 32], num_stage=2, batches=32, gbs=128)
invalid_strategy: dp_deg(32), batches(32), mbs(0)
invalid_strategy: dp_deg(16), batches(32), mbs(0)
invalid_strategy: dp_deg(16), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
valid_strategies: [(4, 8), (4, 8)]
stage_memory_capacity: [2621440, 2621440]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [2585687.999, 2581438.499]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [32, 32], num_stage: 2, batches: 32, gbs: 128, strategies: [(4, 8), (4, 8)], layer_partition: [0, 5, 10]
execution_cost: 1394.619725036621, fb_sync_cost: 343385.1415893555, parameter_upate_costs: 1351.785659790039, dp_cost: 1.1699802564538042, pp_cost: 0.08695652173913043
cost: 376027.0605027572


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[32, 32], num_stage=2, batches=16, gbs=128)
invalid_strategy: dp_deg(32), batches(16), mbs(0)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
valid_strategies: [(8, 4), (8, 4)]
stage_memory_capacity: [2621440, 2621440]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [2585687.999, 2581438.499]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [32, 32], num_stage: 2, batches: 16, gbs: 128, strategies: [(8, 4), (8, 4)], layer_partition: [0, 5, 10]
execution_cost: 717.912565612793, fb_sync_cost: 171692.57079467774, parameter_upate_costs: 2703.571319580078, dp_cost: 2.7299539317255435, pp_cost: 0.08695652173913043
cost: 190063.9998862225


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[32, 32], num_stage=2, batches=8, gbs=128)
invalid_strategy: dp_deg(32), batches(8), mbs(0)
invalid_strategy: dp_deg(32), batches(8), mbs(0)
valid_strategies: [(16, 2), (16, 2)]
stage_memory_capacity: [2621440, 2621440]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [2585687.999, 2581438.499]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [32, 32], num_stage: 2, batches: 8, gbs: 128, strategies: [(16, 2), (16, 2)], layer_partition: [0, 5, 10]
execution_cost: 379.55898590087895, fb_sync_cost: 85846.28539733887, parameter_upate_costs: 5407.142639160156, dp_cost: 5.8499012822690215, pp_cost: 0.08695652173913043
cost: 99112.48802815314


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[32, 32], num_stage=2, batches=4, gbs=128)
valid_strategies: [(32, 1), (32, 1)]
stage_memory_capacity: [2621440, 2621440]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [2585687.999, 2581438.499]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [32, 32], num_stage: 2, batches: 4, gbs: 128, strategies: [(32, 1), (32, 1)], layer_partition: [0, 5, 10]
execution_cost: 210.38219604492187, fb_sync_cost: 42923.142698669435, parameter_upate_costs: 10814.285278320312, dp_cost: 12.089795983355978, pp_cost: 0.08695652173913043
cost: 57696.76899951437


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[32, 32], num_stage=2, batches=2, gbs=128)
valid_strategies: [(32, 1), (32, 1)]
stage_memory_capacity: [2621440, 2621440]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [2585687.999, 2581438.499]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [32, 32], num_stage: 2, batches: 2, gbs: 128, strategies: [(32, 1), (32, 1)], layer_partition: [0, 5, 10]
execution_cost: 125.79380111694337, fb_sync_cost: 21461.571349334718, parameter_upate_costs: 10814.285278320312, dp_cost: 12.089795983355978, pp_cost: 0.17391304347826086
cost: 34282.30517478612


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[32, 32], num_stage=2, batches=1, gbs=128)
valid_strategies: [(32, 1), (32, 1)]
stage_memory_capacity: [2621440, 2621440]
stage_compute_performance: [0.5, 0.5]
layer_partition: [0, 5, 10]
stage_memory_demand: [35752.001, 40001.501], memory_state: [2585687.999, 2581438.499]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [32, 32], num_stage: 2, batches: 1, gbs: 128, strategies: [(32, 1), (32, 1)], layer_partition: [0, 5, 10]
execution_cost: 83.49960365295411, fb_sync_cost: 10730.785674667359, parameter_upate_costs: 10814.285278320312, dp_cost: 12.089795983355978, pp_cost: 0.34782608695652173
cost: 22575.20369720459


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[16, 16, 16, 16], num_stage=4, batches=128, gbs=128)
invalid_strategy: dp_deg(16), batches(128), mbs(0)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 16), (1, 16), (1, 16), (1, 16)]
stage_memory_capacity: [1310720, 1310720, 1310720, 1310720]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [1286926.999, 1298760.999, 1298760.999, 1282677.499]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [16, 16, 16, 16], num_stage: 4, batches: 128, gbs: 128, strategies: [(1, 16), (1, 16), (1, 16), (1, 16)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 2859.757033538818, fb_sync_cost: 1373540.566357422, parameter_upate_costs: 405.5356979370117, dp_cost: 0.0, pp_cost: 0.2608695652173913
cost: 1496383.1463256504


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[16, 16, 16, 16], num_stage=4, batches=64, gbs=128)
invalid_strategy: dp_deg(16), batches(64), mbs(0)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 8), (2, 8), (2, 8), (2, 8)]
stage_memory_capacity: [1310720, 1310720, 1310720, 1310720]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [1286926.999, 1298760.999, 1298760.999, 1282677.499]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [16, 16, 16, 16], num_stage: 4, batches: 64, gbs: 128, strategies: [(2, 8), (2, 8), (2, 8), (2, 8)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 1460.6981712341308, fb_sync_cost: 686770.283178711, parameter_upate_costs: 811.0713958740234, dp_cost: 0.517716117527174, pp_cost: 0.2608695652173913
cost: 748831.3445150956


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[16, 16, 16, 16], num_stage=4, batches=32, gbs=128)
invalid_strategy: dp_deg(16), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
valid_strategies: [(4, 4), (4, 4), (4, 4), (4, 4)]
stage_memory_capacity: [1310720, 1310720, 1310720, 1310720]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [1286926.999, 1298760.999, 1298760.999, 1282677.499]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [16, 16, 16, 16], num_stage: 4, batches: 32, gbs: 128, strategies: [(4, 4), (4, 4), (4, 4), (4, 4)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 761.1687400817871, fb_sync_cost: 343385.1415893555, parameter_upate_costs: 1622.1427917480469, dp_cost: 1.5531483525815217, pp_cost: 0.2608695652173913
cost: 375664.5237309


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[16, 16, 16, 16], num_stage=4, batches=16, gbs=128)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
valid_strategies: [(8, 2), (8, 2), (8, 2), (8, 2)]
stage_memory_capacity: [1310720, 1310720, 1310720, 1310720]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [1286926.999, 1298760.999, 1298760.999, 1282677.499]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [16, 16, 16, 16], num_stage: 4, batches: 16, gbs: 128, strategies: [(8, 2), (8, 2), (8, 2), (8, 2)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 411.4040245056152, fb_sync_cost: 171692.57079467774, parameter_upate_costs: 3244.2855834960938, dp_cost: 3.6240128226902177, pp_cost: 0.2608695652173913
cost: 190299.2735809658


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[16, 16, 16, 16], num_stage=4, batches=8, gbs=128)
valid_strategies: [(16, 1), (16, 1), (16, 1), (16, 1)]
stage_memory_capacity: [1310720, 1310720, 1310720, 1310720]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [1286926.999, 1298760.999, 1298760.999, 1282677.499]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [16, 16, 16, 16], num_stage: 4, batches: 8, gbs: 128, strategies: [(16, 1), (16, 1), (16, 1), (16, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 236.52166671752929, fb_sync_cost: 85846.28539733887, parameter_upate_costs: 6488.5711669921875, dp_cost: 7.765741762907608, pp_cost: 0.2608695652173913
cost: 100052.96899032593


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[16, 16, 16, 16], num_stage=4, batches=4, gbs=128)
valid_strategies: [(16, 1), (16, 1), (16, 1), (16, 1)]
stage_memory_capacity: [1310720, 1310720, 1310720, 1310720]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [1286926.999, 1298760.999, 1298760.999, 1282677.499]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [16, 16, 16, 16], num_stage: 4, batches: 4, gbs: 128, strategies: [(16, 1), (16, 1), (16, 1), (16, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 149.08048782348632, fb_sync_cost: 42923.142698669435, parameter_upate_costs: 6488.5711669921875, dp_cost: 7.765741762907608, pp_cost: 0.5217391304347826
cost: 53305.86390835306


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[16, 16, 16, 16], num_stage=4, batches=2, gbs=128)
valid_strategies: [(16, 1), (16, 1), (16, 1), (16, 1)]
stage_memory_capacity: [1310720, 1310720, 1310720, 1310720]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [1286926.999, 1298760.999, 1298760.999, 1282677.499]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [16, 16, 16, 16], num_stage: 4, batches: 2, gbs: 128, strategies: [(16, 1), (16, 1), (16, 1), (16, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 105.35989837646486, fb_sync_cost: 21461.571349334718, parameter_upate_costs: 6488.5711669921875, dp_cost: 7.765741762907608, pp_cost: 1.0434782608695652
cost: 29932.70267171445


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[16, 16, 16, 16], num_stage=4, batches=1, gbs=128)
valid_strategies: [(16, 1), (16, 1), (16, 1), (16, 1)]
stage_memory_capacity: [1310720, 1310720, 1310720, 1310720]
stage_compute_performance: [0.25, 0.25, 0.25, 0.25]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [23793.001, 11959.001, 11959.001, 28042.501], memory_state: [1286926.999, 1298760.999, 1298760.999, 1282677.499]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [16, 16, 16, 16], num_stage: 4, batches: 1, gbs: 128, strategies: [(16, 1), (16, 1), (16, 1), (16, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 83.49960365295411, fb_sync_cost: 10730.785674667359, parameter_upate_costs: 6488.5711669921875, dp_cost: 7.765741762907608, pp_cost: 2.0869565217391304
cost: 18246.9046620908


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[8, 8, 8, 8, 8, 8, 8, 8], num_stage=8, batches=128, gbs=128)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 8), (1, 8), (1, 8), (1, 8), (1, 8), (1, 8), (1, 8), (1, 8)]
stage_memory_capacity: [655360, 655360, 655360, 655360, 655360, 655360, 655360, 655360]
stage_compute_performance: [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [17813.501, 5979.501, 5979.501, 5979.501, 11959.001, 5979.501, 5979.501, 16083.501], memory_state: [637546.499, 649380.499, 649380.499, 649380.499, 643400.999, 649380.499, 649380.499, 639276.499]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [8, 8, 8, 8, 8, 8, 8, 8], num_stage: 8, batches: 128, gbs: 128, strategies: [(1, 8), (1, 8), (1, 8), (1, 8), (1, 8), (1, 8), (1, 8), (1, 8)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
execution_cost: 2678.6052516937257, fb_sync_cost: 1373540.566357422, parameter_upate_costs: 540.7142639160156, dp_cost: 0.0, pp_cost: 0.6576086956521738
cost: 1496337.5698489146


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[8, 8, 8, 8, 8, 8, 8, 8], num_stage=8, batches=64, gbs=128)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 4), (2, 4), (2, 4), (2, 4), (2, 4), (2, 4), (2, 4), (2, 4)]
stage_memory_capacity: [655360, 655360, 655360, 655360, 655360, 655360, 655360, 655360]
stage_compute_performance: [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [17813.501, 5979.501, 5979.501, 5979.501, 11959.001, 5979.501, 5979.501, 16083.501], memory_state: [637546.499, 649380.499, 649380.499, 649380.499, 643400.999, 649380.499, 649380.499, 639276.499]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [8, 8, 8, 8, 8, 8, 8, 8], num_stage: 8, batches: 64, gbs: 128, strategies: [(2, 4), (2, 4), (2, 4), (2, 4), (2, 4), (2, 4), (2, 4), (2, 4)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
execution_cost: 1370.8354763031007, fb_sync_cost: 686770.283178711, parameter_upate_costs: 1081.4285278320312, dp_cost: 0.7731402853260869, pp_cost: 0.7934782608695652
cost: 749012.626984986


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[8, 8, 8, 8, 8, 8, 8, 8], num_stage=8, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
valid_strategies: [(4, 2), (4, 2), (4, 2), (4, 2), (4, 2), (4, 2), (4, 2), (4, 2)]
stage_memory_capacity: [655360, 655360, 655360, 655360, 655360, 655360, 655360, 655360]
stage_compute_performance: [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [17813.501, 5979.501, 5979.501, 5979.501, 11959.001, 5979.501, 5979.501, 16083.501], memory_state: [637546.499, 649380.499, 649380.499, 649380.499, 643400.999, 649380.499, 649380.499, 639276.499]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [8, 8, 8, 8, 8, 8, 8, 8], num_stage: 8, batches: 32, gbs: 128, strategies: [(4, 2), (4, 2), (4, 2), (4, 2), (4, 2), (4, 2), (4, 2), (4, 2)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
execution_cost: 716.9505886077881, fb_sync_cost: 343385.1415893555, parameter_upate_costs: 2162.8570556640625, dp_cost: 2.3194208559782608, pp_cost: 1.0652173913043477
cost: 376162.5904636715


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[8, 8, 8, 8, 8, 8, 8, 8], num_stage=8, batches=16, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 655360, 655360, 655360, 655360, 655360, 655360]
stage_compute_performance: [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [17813.501, 5979.501, 5979.501, 5979.501, 11959.001, 5979.501, 5979.501, 16083.501], memory_state: [637546.499, 649380.499, 649380.499, 649380.499, 643400.999, 649380.499, 649380.499, 639276.499]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [8, 8, 8, 8, 8, 8, 8, 8], num_stage: 8, batches: 16, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
execution_cost: 390.0081447601318, fb_sync_cost: 171692.57079467774, parameter_upate_costs: 4325.714111328125, dp_cost: 5.411981997282609, pp_cost: 1.608695652173913
cost: 191362.44202431387


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[8, 8, 8, 8, 8, 8, 8, 8], num_stage=8, batches=8, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 655360, 655360, 655360, 655360, 655360, 655360]
stage_compute_performance: [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [17813.501, 5979.501, 5979.501, 5979.501, 11959.001, 5979.501, 5979.501, 16083.501], memory_state: [637546.499, 649380.499, 649380.499, 649380.499, 643400.999, 649380.499, 649380.499, 639276.499]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [8, 8, 8, 8, 8, 8, 8, 8], num_stage: 8, batches: 8, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
execution_cost: 226.53692283630372, fb_sync_cost: 85846.28539733887, parameter_upate_costs: 4325.714111328125, dp_cost: 5.411981997282609, pp_cost: 3.217391304347826
cost: 97880.72995275415


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[8, 8, 8, 8, 8, 8, 8, 8], num_stage=8, batches=4, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 655360, 655360, 655360, 655360, 655360, 655360]
stage_compute_performance: [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [17813.501, 5979.501, 5979.501, 5979.501, 11959.001, 5979.501, 5979.501, 16083.501], memory_state: [637546.499, 649380.499, 649380.499, 649380.499, 643400.999, 649380.499, 649380.499, 639276.499]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [8, 8, 8, 8, 8, 8, 8, 8], num_stage: 8, batches: 4, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
execution_cost: 144.80131187438965, fb_sync_cost: 42923.142698669435, parameter_upate_costs: 4325.714111328125, dp_cost: 5.411981997282609, pp_cost: 6.434782608695652
cost: 51142.28696045254


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[8, 8, 8, 8, 8, 8, 8, 8], num_stage=8, batches=2, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 655360, 655360, 655360, 655360, 655360, 655360]
stage_compute_performance: [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [17813.501, 5979.501, 5979.501, 5979.501, 11959.001, 5979.501, 5979.501, 16083.501], memory_state: [637546.499, 649380.499, 649380.499, 649380.499, 643400.999, 649380.499, 649380.499, 639276.499]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [8, 8, 8, 8, 8, 8, 8, 8], num_stage: 8, batches: 2, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
execution_cost: 103.93350639343262, fb_sync_cost: 21461.571349334718, parameter_upate_costs: 4325.714111328125, dp_cost: 5.411981997282609, pp_cost: 12.869565217391305
cost: 27777.891551258257


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>,), dg_idx=0, device_groups=[8, 8, 8, 8, 8, 8, 8, 8], num_stage=8, batches=1, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 655360, 655360, 655360, 655360, 655360, 655360]
stage_compute_performance: [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [17813.501, 5979.501, 5979.501, 5979.501, 11959.001, 5979.501, 5979.501, 16083.501], memory_state: [637546.499, 649380.499, 649380.499, 649380.499, 643400.999, 649380.499, 649380.499, 639276.499]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>,), device_group: [8, 8, 8, 8, 8, 8, 8, 8], num_stage: 8, batches: 1, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
execution_cost: 83.49960365295411, fb_sync_cost: 10730.785674667359, parameter_upate_costs: 4325.714111328125, dp_cost: 5.411981997282609, pp_cost: 25.73913043478261
cost: 16105.346020574154
Total_time: 0.05 seconds
mark:6
len(costs): 32
rank, cost, node_sequence, device_groups, strategies(dp_deg, tp_deg), batches(number of batch), layer_partition
1, 16105.346020574154, (<DeviceType.A100: 'a100'>,), [8, 8, 8, 8, 8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)], 1, [0, 2, 3, 4, 5, 7, 8, 9, 10]
2, 18246.9046620908, (<DeviceType.A100: 'a100'>,), [16, 16, 16, 16], [(16, 1), (16, 1), (16, 1), (16, 1)], 1, [0, 3, 5, 7, 10]
3, 22575.20369720459, (<DeviceType.A100: 'a100'>,), [32, 32], [(32, 1), (32, 1)], 1, [0, 5, 10]
4, 27777.891551258257, (<DeviceType.A100: 'a100'>,), [8, 8, 8, 8, 8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)], 2, [0, 2, 3, 4, 5, 7, 8, 9, 10]
5, 29932.70267171445, (<DeviceType.A100: 'a100'>,), [16, 16, 16, 16], [(16, 1), (16, 1), (16, 1), (16, 1)], 2, [0, 3, 5, 7, 10]
6, 33401.62077165686, (<DeviceType.A100: 'a100'>,), [64], [(64, 1)], 1, [0, 10]
7, 34282.30517478612, (<DeviceType.A100: 'a100'>,), [32, 32], [(32, 1), (32, 1)], 2, [0, 5, 10]
8, 45150.10156847083, (<DeviceType.A100: 'a100'>,), [64], [(64, 1)], 2, [0, 10]
9, 51142.28696045254, (<DeviceType.A100: 'a100'>,), [8, 8, 8, 8, 8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)], 4, [0, 2, 3, 4, 5, 7, 8, 9, 10]
10, 53305.86390835306, (<DeviceType.A100: 'a100'>,), [16, 16, 16, 16], [(16, 1), (16, 1), (16, 1), (16, 1)], 4, [0, 3, 5, 7, 10]
11, 57696.76899951437, (<DeviceType.A100: 'a100'>,), [32, 32], [(32, 1), (32, 1)], 4, [0, 5, 10]
12, 57820.298179294754, (<DeviceType.A100: 'a100'>,), [64], [(32, 2)], 4, [0, 10]
13, 97880.72995275415, (<DeviceType.A100: 'a100'>,), [8, 8, 8, 8, 8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)], 8, [0, 2, 3, 4, 5, 7, 8, 9, 10]
14, 99112.48802815314, (<DeviceType.A100: 'a100'>,), [32, 32], [(16, 2), (16, 2)], 8, [0, 5, 10]
15, 99400.8388751486, (<DeviceType.A100: 'a100'>,), [64], [(16, 4)], 8, [0, 10]
16, 100052.96899032593, (<DeviceType.A100: 'a100'>,), [16, 16, 16, 16], [(16, 1), (16, 1), (16, 1), (16, 1)], 8, [0, 3, 5, 7, 10]
17, 190063.9998862225, (<DeviceType.A100: 'a100'>,), [32, 32], [(8, 4), (8, 4)], 16, [0, 5, 10]
18, 190299.2735809658, (<DeviceType.A100: 'a100'>,), [16, 16, 16, 16], [(8, 2), (8, 2), (8, 2), (8, 2)], 16, [0, 3, 5, 7, 10]
19, 190681.99400395932, (<DeviceType.A100: 'a100'>,), [64], [(8, 8)], 16, [0, 10]
20, 191362.44202431387, (<DeviceType.A100: 'a100'>,), [8, 8, 8, 8, 8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1), (8, 1)], 16, [0, 2, 3, 4, 5, 7, 8, 9, 10]
21, 375664.5237309, (<DeviceType.A100: 'a100'>,), [16, 16, 16, 16], [(4, 4), (4, 4), (4, 4), (4, 4)], 32, [0, 3, 5, 7, 10]
22, 376027.0605027572, (<DeviceType.A100: 'a100'>,), [32, 32], [(4, 8), (4, 8)], 32, [0, 5, 10]
23, 376162.5904636715, (<DeviceType.A100: 'a100'>,), [8, 8, 8, 8, 8, 8, 8, 8], [(4, 2), (4, 2), (4, 2), (4, 2), (4, 2), (4, 2), (4, 2), (4, 2)], 32, [0, 2, 3, 4, 5, 7, 8, 9, 10]
24, 377304.34113013226, (<DeviceType.A100: 'a100'>,), [64], [(4, 16)], 32, [0, 10]
25, 748831.3445150956, (<DeviceType.A100: 'a100'>,), [16, 16, 16, 16], [(2, 8), (2, 8), (2, 8), (2, 8)], 64, [0, 3, 5, 7, 10]
26, 749012.626984986, (<DeviceType.A100: 'a100'>,), [8, 8, 8, 8, 8, 8, 8, 8], [(2, 4), (2, 4), (2, 4), (2, 4), (2, 4), (2, 4), (2, 4), (2, 4)], 64, [0, 2, 3, 4, 5, 7, 8, 9, 10]
27, 749983.2001860245, (<DeviceType.A100: 'a100'>,), [32, 32], [(2, 16), (2, 16)], 64, [0, 5, 10]
28, 752579.0538167539, (<DeviceType.A100: 'a100'>,), [64], [(2, 32)], 64, [0, 10]
29, 1496337.5698489146, (<DeviceType.A100: 'a100'>,), [8, 8, 8, 8, 8, 8, 8, 8], [(1, 8), (1, 8), (1, 8), (1, 8), (1, 8), (1, 8), (1, 8), (1, 8)], 128, [0, 2, 3, 4, 5, 7, 8, 9, 10]
30, 1496383.1463256504, (<DeviceType.A100: 'a100'>,), [16, 16, 16, 16], [(1, 16), (1, 16), (1, 16), (1, 16)], 128, [0, 3, 5, 7, 10]
31, 1498910.4887776582, (<DeviceType.A100: 'a100'>,), [32, 32], [(1, 32), (1, 32)], 128, [0, 5, 10]
32, 1504143.488407135, (<DeviceType.A100: 'a100'>,), [64], [(1, 64)], 128, [0, 10]
